<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Trail Recommendation - TrailForge</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-image: url('background.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #fc4c02 0%, #e04402 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .section {
            margin-bottom: 35px;
        }

        .section h2 {
            color: #fc4c02;
            font-size: 1.8em;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #fc4c02;
        }

        .section h3 {
            color: #333;
            font-size: 1.4em;
            margin-bottom: 15px;
            margin-top: 25px;
        }

        .section p {
            color: #444;
            line-height: 1.8;
            font-size: 1.05em;
            margin-bottom: 15px;
        }

        .trail-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 25px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .stat-item {
            text-align: center;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }

        .stat-label {
            font-size: 0.9em;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }

        .stat-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #fc4c02;
        }

        .fitness-summary {
            background: #e8f5e9;
            border-left: 4px solid #4caf50;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 25px;
        }

        .fitness-summary p {
            color: #2e7d32;
            margin: 0;
        }

        .trail-description {
            background: #fff3e0;
            border-left: 4px solid #ff9800;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
        }

        .weather-info {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
        }

        .cta-button {
            display: inline-block;
            background: #fc4c02;
            color: white;
            padding: 15px 35px;
            border-radius: 8px;
            text-decoration: none;
            font-size: 1.1em;
            font-weight: bold;
            transition: all 0.3s ease;
            margin-top: 20px;
            box-shadow: 0 4px 15px rgba(252, 76, 2, 0.3);
        }

        .cta-button:hover {
            background: #e04402;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(252, 76, 2, 0.4);
        }

        .highlight {
            color: #fc4c02;
            font-weight: 600;
        }

        .activity-examples {
            font-style: italic;
            color: #555;
        }

        @media (max-width: 768px) {
            .content {
                padding: 25px;
            }

            .header h1 {
                font-size: 1.5em;
            }

            .trail-stats {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèîÔ∏è Your Personalized Trail Recommendation</h1>
            <p>Based on your Strava activity analysis</p>
        </div>

        <div class="content">
            <!-- Fitness Summary Section -->
            <div class="section">
                <h2>Your Fitness Profile</h2>
                <div class="fitness-summary">
                    <p id="fitnessText">Loading your fitness analysis...</p>
                </div>
            </div>

            <!-- Trail Recommendation Section -->
            <div class="section">
                <h2>Recommended Trail</h2>
                <h3 id="trailName">Loading recommendation...</h3>

                <div class="trail-stats" id="trailStats">
                    <!-- Stats will be dynamically inserted -->
                </div>

                <div class="trail-description">
                    <p id="trailSummary">Loading trail description...</p>
                </div>
            </div>

            <!-- Weather Section -->
            <div class="section">
                <h2>Weather Forecast</h2>
                <div class="weather-info">
                    <p id="weatherInfo">Loading weather information...</p>
                </div>
            </div>

            <!-- Call to Action -->
            <div class="section" style="text-align: center;">
                <a href="#" id="alltrailsLink" class="cta-button" target="_blank">
                    View on AllTrails ‚Üí
                </a>
            </div>
        </div>
    </div>

    <script>
        // This function will parse and display the recommendation text
        function displayRecommendation(recommendationText) {
            // Parse fitness summary (first paragraph)
            const paragraphs = recommendationText.split('\n\n');
            const fitnessParagraph = paragraphs[0];

            // Extract activity examples with formatting
            const formattedFitness = fitnessParagraph
                .replace(/"([^"]+)" \(([^)]+)\)/g, '<span class="activity-examples">"$1" ($2)</span>');

            document.getElementById('fitnessText').innerHTML = formattedFitness;

            // Extract trail name
            const trailNameMatch = recommendationText.match(/\*\*([^*]+)\*\*/);
            if (trailNameMatch) {
                document.getElementById('trailName').textContent = trailNameMatch[1];
            }

            // Extract trail stats
            const distanceMatch = recommendationText.match(/Distance[:\s]*~?([^\n]+)/);
            const elevationMatch = recommendationText.match(/Elevation Gain[:\s]*~?([^\n]+)/);
            const difficultyMatch = recommendationText.match(/Difficulty[:\s]*([^\n]+)/);
            const durationMatch = recommendationText.match(/Recommended Duration[:\s]*([^\n]+)/);
            const trailTypeMatch = recommendationText.match(/Trail Type[:\s]*([^\n]+)/);

            const statsHTML = `
                ${distanceMatch ? `<div class="stat-item"><div class="stat-label">Distance</div><div class="stat-value">${distanceMatch[1].trim()}</div></div>` : ''}
                ${elevationMatch ? `<div class="stat-item"><div class="stat-label">Elevation Gain</div><div class="stat-value">${elevationMatch[1].trim()}</div></div>` : ''}
                ${difficultyMatch ? `<div class="stat-item"><div class="stat-label">Difficulty</div><div class="stat-value">${difficultyMatch[1].trim()}</div></div>` : ''}
                ${trailTypeMatch ? `<div class="stat-item"><div class="stat-label">Trail Type</div><div class="stat-value">${trailTypeMatch[1].trim()}</div></div>` : ''}
                ${durationMatch ? `<div class="stat-item"><div class="stat-label">Duration</div><div class="stat-value">${durationMatch[1].trim()}</div></div>` : ''}
            `;
            document.getElementById('trailStats').innerHTML = statsHTML;

            // Extract trail summary
            const summaryMatch = recommendationText.match(/\*\*Trail Summary\*\*:\s*([^*]+?)(?=\*\*|$)/s);
            if (summaryMatch) {
                document.getElementById('trailSummary').textContent = summaryMatch[1].trim();
            }

            // Extract weather forecast
            const weatherMatch = recommendationText.match(/\*\*Weather Forecast[^:]*\*\*:\s*([^*]+?)(?=\*\*|$)/s);
            if (weatherMatch) {
                document.getElementById('weatherInfo').textContent = weatherMatch[1].trim();
            }

            // Extract AllTrails link
            const linkMatch = recommendationText.match(/\[([^\]]+)\]\((https?:\/\/[^)]+)\)/);
            if (linkMatch) {
                const alltrailsLink = document.getElementById('alltrailsLink');
                alltrailsLink.href = linkMatch[2];
            }
        }

        // Example usage - replace this with actual API call
        // For now, this demonstrates the parsing with your example text
        const exampleRecommendation = `Based on your activity data, you are a highly fit individual with a strong preference for challenging hikes, including multi-day backpacking. Your recent activities like "Mt. Shasta" (9.55 miles, 5051.84 feet elevation gain), "Zion Narrows Shuttle Service" (13.70 miles, 1655.51 feet), and especially "Calm luh backpack" (11.76 miles, 2035.11 feet) demonstrate excellent endurance, a willingness to tackle significant elevation, and experience with longer, multi-day efforts. Your running data further confirms a high level of general cardiovascular fitness.

For your July backpacking trip, I recommend a classic and strenuous Sierra Nevada experience.

**Rae Lakes Loop**
- **Distance**: ~41 miles
- **Elevation Gain**: ~7,800 feet (cumulative)
- **Difficulty**: Strenuous
- **Trail Type**: Loop
- **Recommended Duration**: 4-5 days / 3-4 nights

**Trail Summary**: This iconic loop in Kings Canyon National Park traverses stunning high-alpine landscapes, featuring crystal-clear Rae Lakes nestled among towering granite peaks. Hikers will cross the formidable Glen Pass (11,940 ft), offering panoramic views of the Sierra Nevada, and experience lush river valleys, dense forests, and dramatic granite cirques. Expect varied terrain, from challenging climbs to scenic descents, with abundant opportunities for wildlife viewing and enjoying pristine wilderness. This trail is a quintessential Sierra Nevada backpacking adventure, perfectly suited to your demonstrated fitness and preference for elevation.

**Weather Forecast for July**: In July, the Rae Lakes Loop typically experiences warm, sunny days (often 60s-80s F in valleys, cooler at elevation) and cool to cold nights (30s-50s F). Afternoon thunderstorms are a common occurrence in the Sierra Nevada during summer, so be prepared for rain and potential hail. While major snow will generally have melted from Glen Pass by mid-July, scattered patches may remain, especially on north-facing slopes. Water sources are abundant.

**AllTrails Link**: [https://www.alltrails.com/trail/us/california/rae-lakes-loop](https://www.alltrails.com/trail/us/california/rae-lakes-loop)`;

        // Call the function when page loads
        window.addEventListener('DOMContentLoaded', () => {
            // Fetch recommendation from API
            fetch('/api/recommendation')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Failed to fetch recommendation');
                    }
                    return response.json();
                })
                .then(data => {
                    displayRecommendation(data.recommendation);
                })
                .catch(error => {
                    console.error('Error fetching recommendation:', error);
                    // Fallback to example if API call fails
                    displayRecommendation(exampleRecommendation);
                });
        });
    </script>
</body>
</html>
